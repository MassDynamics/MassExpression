---
title: "Benchmark MassExpression"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(MassExpression)
library(tidyverse)
library(plotly)

make_long_wide_df <- function(matrix_prot, new_int_col = "IntME"){
  int_prot <- data.frame(matrix_prot)
  int_prot$ProteinId <- rownames(int_prot)
  long_int_me <- int_prot %>% pivot_longer(cols = c(LFQ.intensity.1_hu_C1:LFQ.intensity.6_hu_P3), 
                                      values_to = new_int_col, names_to = "SampleName")
  long_int_me$SampleName <- gsub("LFQ.intensity.","", long_int_me$SampleName)
  long_int_me$SampleName <- tolower(long_int_me$SampleName)
  return(long_int_me)
}
```

# Benchmark using Max Quant HER2 data and comparing the result with MaxQuant Discovery workflow

## Load MaxQuant output and convert to generic format

- Load raw data returned by MaxQuant
- Convert to generic format `MaxQuantTranform`

```{r}
mq_data_input <- "../../../data-s3/data-formats/maxquant/LFQ/HER2/data/"
protein.intensities <- read.csv(file.path(mq_data_input, "proteinGroups.txt"), sep = "\t", stringsAsFactors = F)
design <- read.csv(file.path(mq_data_input, "experimentDesign_original.txt"), sep = "\t", stringsAsFactors = F)

input_gen <- MaxQuantTranform(proteinGroups=protein.intensities, design = design, species = "human", useNormalisationMethod = "None", labellingMethod = "LFQ")
data_int_me <- input_gen$intensities
data_int_me[data_int_me$ProteinId == "Q9Y2F5",]
colnames(data_int_me) <- gsub("LFQ.", "lfq.", colnames(data_int_me))
```


## Load HER2 output after running LFQprocessing

```{r}
output_folder <- "../../../data-s3/data-formats/maxquant/LFQ/HER2/data/output/"

# library(LFQprocessing)
# her2 <- protein_quant_runner(upload_folder, output_folder)

out_data <- read.delim(file.path(output_folder, "proteinGroups_quant.txt")) %>%
  dplyr::rename(Majority.protein.IDs=majority.protein.ids,
                Fasta.headers=fasta.headers)
out_data_1prot <- assign_uniprot_ids_mq(out_data)
out_data_bench <- out_data_1prot %>% dplyr::select("ProteinId",
                                             starts_with("logFC."), 
                                             starts_with("adj.P.Val."), 
                                             starts_with("P.Value.")) 
colnames(out_data_bench)[2:ncol(out_data_bench)] <- paste0("Disco_", colnames(out_data_bench)[2:ncol(out_data_bench)])

# Intensities
lfq_intensities <- out_data_1prot %>% dplyr::select(ProteinId, starts_with("lfq."))
#out_data_1prot[out_data_1prot$ProteinId == "Q9Y2F5",] %>% select(starts_with("LFQ.intensity"))
```

## Run MassExpression discovery

```{r me-discovery}
intensities <- input_gen$intensities
design <- input_gen$design
parameters <- input_gen$parameters
normalisation_method <- parameters[parameters[,1] == "UseNormalisationMethod",2]
species <- parameters[parameters[,1] == "Species",2]
labellingMethod <- parameters[parameters[,1] == "LabellingMethod",2]

#intensities <- read_delim("../data-private/protein_intensities.tsv", delim = "\t")
#design <- read_delim("../data-private/experiment_design.tsv", delim = "\t")
#parameters <- read_delim("../data-private/parameters.tsv", delim = "\t")

results <- runGenericDiscovery(experimentDesign = design, 
                               proteinIntensities = intensities, 
                               normalisationMethod = normalisation_method, 
                               species = species, 
                               labellingMethod = labellingMethod)

completeExperiment <- results$CompleteIntensityExperiment
inten <- results$IntensityExperiment

comparisonExperiments <- 
    listComparisonExperiments(completeExperiment)
  
saveOutput(IntensityExperiment = inten, CompleteIntensityExperiment = completeExperiment, output_folder =  ".")
```

## Compare logFC and Pvals between MassExpression and LFQprocessing

```{r}
expected_complete_new <- rowData(completeExperiment)
expected_comparison_new_run <- rowData(comparisonExperiments[[1]])

sum(!(out_data_bench$ProteinId %in% expected_complete_new$ProteinId))
sum(!(out_data_bench$ProteinId %in% expected_comparison$ProteinId))
sum(!(expected_complete_new$ProteinId %in% out_data_bench$ProteinId))
sum(!(expected_comparison$ProteinId %in% out_data_bench$ProteinId))

compare_new_run <- out_data_bench %>% left_join(as_tibble(expected_comparison_new_run))


expected_diff_fc_maxquant <- compare_new_run$FC - compare_new_run$Disco_logFC.AZD8931_resistant_SKBR3_AZDRc...Parental_SKBR3

expected_diff_pval_maxquant <- compare_new_run$P.Value - compare_new_run$Disco_P.Value.AZD8931_resistant_SKBR3_AZDRc...Parental_SKBR3

data_bench_maxquant <- out_data_bench
save(data_bench_maxquant, expected_diff_fc_maxquant, expected_diff_pval_maxquant, file = "../tests/data/HER2_maxquant_workflow.RData")
```


```{r}
ggplot(compare_new_run, aes(x=FC, 
                    y = `Disco_logFC.AZD8931_resistant_SKBR3_AZDRc...Parental_SKBR3`)) + 
  geom_point() +
  theme_bw() +
  geom_smooth()+
  ggtitle("Proteins used in pairwise comparison")
```


```{r}
compare_new_run$NImpute <- compare_new_run$NImputed..Parental_SKBR3 + compare_new_run$NImputed..AZD8931_resistant_SKBR3_AZDRc
ggplot(compare_new_run, aes(x=-log10(P.Value), 
                    y = -log10(`Disco_P.Value.AZD8931_resistant_SKBR3_AZDRc...Parental_SKBR3`), colour=NImpute)) + 
  geom_point() +
  theme_bw() +
  geom_smooth()+
  scale_colour_viridis_c()+
  ggtitle("using proteins used in pairwise comparison")
```


```{r}
compare$diffPval <- (compare$Disco_P.Value.AZD8931_resistant_SKBR3_AZDRc...Parental_SKBR3 - compare$P.Value.AZD8931_resistant_SKBR3_AZDRc.Parental_SKBR3) > 0.001 
table(compare$diffPval)
```

```{r}
diff_true <- NULL
for(diff in seq(0,1,0.001)){
  compare$diffPval <- (compare$Disco_P.Value.AZD8931_resistant_SKBR3_AZDRc...Parental_SKBR3 - compare$P.Value.AZD8931_resistant_SKBR3_AZDRc.Parental_SKBR3) > diff
  num <- ifelse(is.na(table(compare$diffPval)[2]), 0, as.numeric(table(compare$diffPval)[2]))
  diff_true <-  c(diff_true, num)
}

plot(seq(0,1,0.001), diff_true)
```


```{r}
compare$anyImpute <- compare$NImputed..Parental_SKBR3 + compare$NImputed..AZD8931_resistant_SKBR3_AZDRc > 0
ggplot(compare, aes(x=`P.Value.AZD8931_resistant_SKBR3_AZDRc.Parental_SKBR3`, 
                    y = `Disco_P.Value.AZD8931_resistant_SKBR3_AZDRc...Parental_SKBR3`, colour=anyImpute)) + 
  geom_point() +
  theme_bw() +
  geom_smooth()
```

## Compare with data used for testings

```{r}
load("../tests/data/mq_lfq_output.Rdata")

expected_complete <- rowData(expectedCompleteIntensityExperiment)
data <- assay(expectedIntensityExperiment)

expected_comparison <- rowData(expectedcomparisonExperiments[[1]])

sum(!(out_data_bench$ProteinId %in% expected_complete$ProteinId))
sum(!(expected_complete$ProteinId %in% out_data_bench$ProteinId))

compare <- out_data_bench %>% left_join(as_tibble(expected_comparison))
```

### Compare test data with new run of MassExpression 

```{r}
expected_comparison_data <- expected_comparison[, c("P.Value", "FC","ProteinId")]
expected_comparison_new_run_data <- expected_comparison_new_run[, c("P.Value", "FC", "ProteinId")]

expected_comparison_data <- data.frame(expected_comparison_data) %>% dplyr::rename(P.Value_test = P.Value, 
                                                                       FC_test = FC) %>%
  left_join(data.frame(expected_comparison_new_run_data))

plot(-log10(expected_comparison_data$P.Value), -log10(expected_comparison_data$P.Value_test))
```


```{r}
p=ggplot(compare, aes(x=-log10(P.Value), 
                    y = -log10(`Disco_P.Value.AZD8931_resistant_SKBR3_AZDRc...Parental_SKBR3`), label=ProteinId)) + 
  geom_point() +
  theme_bw() +
  ggtitle("Test data: Using only proteins used in the comparison")

ggplotly(p)
```


```{r}
ggplot(compare, aes(x=FC, 
                    y = `Disco_logFC.AZD8931_resistant_SKBR3_AZDRc...Parental_SKBR3`)) + 
  geom_point() +
  theme_bw() +
  geom_smooth()+
   ggtitle("Test data: Using only proteins used in the comparison")
```


# Compare steps

- Initial intensities
- Log2
- Imputed


## Compare intensities

```{r}
colnames(data_int_me)[1:(ncol(data_int_me)-1)] <- paste0("MEstart_", colnames(data_int_me)[1:(ncol(data_int_me)-1)])

colnames(lfq_intensities)[2:(ncol(lfq_intensities))] <- paste0("MQstart_", colnames(lfq_intensities)[2:ncol(lfq_intensities)])

compare_initial <- lfq_intensities %>% left_join(data_int_me)
```


```{r}
sum(!(compare_initial$MQstart_lfq.intensity.1_hu_c1==compare_initial$MEstart_lfq.intensity.1_hu_C1))
ggplot(compare_initial, aes(x = MQstart_lfq.intensity.1_hu_c1, y = MEstart_lfq.intensity.1_hu_C1)) + geom_point()
```

```{r}
sum(!(compare_initial$MQstart_lfq.intensity.3_hu_c2==compare_initial$MEstart_lfq.intensity.3_hu_C2))
ggplot(compare_initial, aes(x = MQstart_lfq.intensity.3_hu_c2, y = MEstart_lfq.intensity.3_hu_C2)) + geom_point()
```


```{r}
sum(!(compare_initial$MQstart_lfq.intensity.5_hu_c3==compare_initial$MEstart_lfq.intensity.5_hu_C3))

ggplot(compare_initial, aes(x = MQstart_lfq.intensity.5_hu_c3, y = MEstart_lfq.intensity.5_hu_C3)) + geom_point()
```

```{r}
ggplot(compare_initial, aes(x = MQstart_lfq.intensity.4_hu_p2, y = MEstart_lfq.intensity.4_hu_P2)) + geom_point()
```



```{r}
ggplot(compare_initial, aes(x = MQstart_lfq.intensity.6_hu_p3, y = MEstart_lfq.intensity.6_hu_P3)) + geom_point()
```

Initial data is the same. 

## Exaclty before imputation

- P0DPI2 1_hu_c1
- P0DPI2 2_hu_p1

```{r exactly-pre-imp}
exactly_pre_imp_mq <- readRDS( "merge_dt_pre_imp.rds")
exactly_pre_imp_me <- readRDS("longIntensityDT_preImp.rds")

exactly_pre_imp_me$SampleName <- gsub("LFQ.intensity.","", me$SampleName)
exactly_pre_imp_me$SampleName <- tolower(me$SampleName)

exactly_pre_imp_mq <- exactly_pre_imp_mq %>%
  dplyr::rename(Majority.protein.IDs=`majority protein ids`,
                Fasta.headers=`fasta headers`) %>%
  dplyr::rename(SampleName = mqExperiment)
mq_1prot <- assign_uniprot_ids_mq(exactly_pre_imp_mq)

compare_pre_impute <- exactly_pre_imp_me[,c("ProteinId","SampleName","log2NIntNorm")] %>% 
  left_join(mq_1prot[c("ProteinId", "SampleName","log2NInt")]) 
```

```{r}
ggplot(compare_pre_impute, aes(x = log2NIntNorm, y = log2NInt)) + geom_point()
```

They are the same exactly pre-imputation. 

## Exaclty one line before imputation

```{r exactly-pre-imp}
exactly_pre_imp_mq <- readRDS( "../../check_imputation_steps/one_line_pre_imp_MQ.rds")
exactly_pre_imp_me <- readRDS("../../check_imputation_steps/one_line_pre_imp_ME.rds")

exactly_pre_imp_me$SampleName <- gsub("LFQ.intensity.","", exactly_pre_imp_me$SampleName)
exactly_pre_imp_me$SampleName <- tolower(exactly_pre_imp_me$SampleName)

mq_with_ids <- readRDS("merge_dt.rds") %>%
  dplyr::select(`majority protein ids`, `fasta headers`, id)

exactly_pre_imp_mq <- readRDS("one_line_pre_imp_MQ.rds")

# int_impute = log2Int
exactly_pre_imp_mq <- as_tibble(exactly_pre_imp_mq) %>%
  left_join(mq_with_ids) %>%
  dplyr::rename(Majority.protein.IDs=`majority protein ids`,
                Fasta.headers=`fasta headers`) %>%
  dplyr::rename(SampleName = mqExperiment)
mq_1prot <- assign_uniprot_ids_mq(exactly_pre_imp_mq)

compare_pre_impute <- exactly_pre_imp_me[,c("ProteinId","SampleName","int_impute")] %>% 
  dplyr::rename(log2NIntNorm = int_impute) %>%
  left_join(mq_1prot[c("ProteinId", "SampleName","int_impute")]) 
```

```{r}
ggplot(compare_pre_impute, aes(x = log2NIntNorm, y = int_impute)) + geom_point()
```

## One line post imputation

**MQ**
Browse[2]> print(impute.position)
[1] 20.7954
Browse[2]> print(impute.StdDev)
[1] 0.594846

**ME**
Browse[2]> impute.position
[1] 20.7954
Browse[2]> impute.StdDev
[1] 0.594846
Browse[2]> 

```{r exactly-pre-imp}
exactly_post_imp_mq <- readRDS( "../../check_imputation_steps/one_line_post_imp_MQ.rds")
exactly_post_imp_me <- readRDS("../../check_imputation_steps/one_line_post_imp_ME.rds")

exactly_post_imp_me$SampleName <- gsub("LFQ.intensity.","", exactly_post_imp_me$SampleName)
exactly_post_imp_me$SampleName <- tolower(exactly_post_imp_me$SampleName)

mq_with_ids <- readRDS("../../check_imputation_steps/merge_dt.rds") %>%
  dplyr::select(`majority protein ids`, `fasta headers`, id, mqExperiment)

# int_impute = log2Int
exactly_post_imp_mq <- as_tibble(exactly_post_imp_mq) %>%
  left_join(mq_with_ids) %>%
  dplyr::rename(Majority.protein.IDs=`majority protein ids`,
                Fasta.headers=`fasta headers`) %>%
  dplyr::rename(SampleName = mqExperiment)

mq_1prot <- assign_uniprot_ids_mq(exactly_post_imp_mq)
mq_1prot <- mq_1prot %>%  
  dplyr::select("ProteinId", "SampleName", "int_impute") 

exactly_post_imp_me <- exactly_post_imp_me %>% 
  select("ProteinId","SampleName","int_impute","Imputed") %>% 
  dplyr::rename(log2NIntNorm = int_impute, ImputedME = Imputed) 

# cbind_compare <- cbind(exactly_post_imp_me, mq_1prot)

compare_post_impute <- exactly_post_imp_me[,c("ProteinId","SampleName","log2NIntNorm","ImputedME")] %>% 
  left_join(mq_1prot[c("ProteinId", "SampleName","int_impute")]) 
```


```{r}
ggplot(compare_post_impute, aes(x = log2NIntNorm, y = int_impute)) + geom_point()
```


```{r}
ggplot(cbind_compare[ImputedME==1], aes(x = log2NIntNorm, y = int_impute)) + geom_point() +
  labs(x="vector imputed MassExpression", y = "vector imputed maxquant")
```


```{r}
compare_post_impute$diff <- compare_post_impute$log2NIntNorm != compare_post_impute$int_impute
table(compare_post_impute$diff)
head(compare_post_impute[compare_post_impute$diff,])
```
P0DPI2
A0A0U1RRL7

```{r}
table(compare_post_impute$diff, compare_post_impute$Imputed)
```


## Before creating the complete SE

```{r}
before_se <- readRDS("../../check_imputation_steps/longIntensityDT_ME_before_create_final.rds")
exactly_post_imp_mq <- readRDS( "../../check_imputation_steps/one_line_post_imp_MQ.rds")

before_se$SampleName <- gsub("LFQ.intensity.","", before_se$SampleName)
before_se$SampleName <- tolower(before_se$SampleName)

mq_with_ids <- readRDS("../../check_imputation_steps/merge_dt.rds") %>%
  dplyr::select(`majority protein ids`, `fasta headers`, id, mqExperiment)

# int_impute = log2Int
exactly_post_imp_mq <- as_tibble(exactly_post_imp_mq) %>%
  left_join(mq_with_ids) %>%
  dplyr::rename(Majority.protein.IDs=`majority protein ids`,
                Fasta.headers=`fasta headers`) %>%
  dplyr::rename(SampleName = mqExperiment)

mq_1prot <- assign_uniprot_ids_mq(exactly_post_imp_mq)
mq_1prot <- mq_1prot %>%  
  dplyr::select("ProteinId", "SampleName", "int_impute") 

before_se <- before_se %>% 
  select("ProteinId","SampleName","log2NIntNorm","Imputed") %>% 
  dplyr::rename(ImputedME = Imputed) 

compare_pre_se <- before_se[,c("ProteinId","SampleName","log2NIntNorm","ImputedME")] %>% 
  left_join(mq_1prot[c("ProteinId", "SampleName","int_impute")]) 
```


```{r}
ggplot(compare_pre_se, aes(x = log2NIntNorm, y = int_impute)) + geom_point()
```

## After creating summarised experiment

```{r}
intens_end <- data.frame(assay(completeExperiment))
intens_end$ProteinId <- rownames(intens_end)
long_me <- intens_end %>% pivot_longer(cols = LFQ.intensity.1_hu_C1:LFQ.intensity.6_hu_P3,
                                     values_to = "IntME", names_to = "SampleName")

long_me$SampleName <- gsub("LFQ.intensity.","", long_me$SampleName)
long_me$SampleName <- tolower(long_me$SampleName)

compare_end_se <- long_me[,c("ProteinId","SampleName","IntME")] %>% 
  left_join(mq_1prot[c("ProteinId", "SampleName","int_impute")]) 

ggplot(compare_end_se, aes(x = IntME, y = int_impute)) + geom_point()
```

## Compare with the data created in App

```{r}
load(file.path("../dev/bench-enrichment/upload/","DiscoveryQuant.RData"))
complete_app <- CompleteIntensityExperiment

intens_end <- data.frame(assay(complete_app))
intens_end$ProteinId <- rownames(intens_end)
long_me <- intens_end %>% pivot_longer(cols = LFQ.intensity.1_hu_C1:LFQ.intensity.6_hu_P3,
                                     values_to = "IntME", names_to = "SampleName")

long_me$SampleName <- gsub("LFQ.intensity.","", long_me$SampleName)
long_me$SampleName <- tolower(long_me$SampleName)

# MQ
exactly_post_imp_mq <- readRDS( "../../check_imputation_steps/one_line_post_imp_MQ.rds")
mq_with_ids <- readRDS("../../check_imputation_steps/merge_dt.rds") %>%
  dplyr::select(`majority protein ids`, `fasta headers`, id, mqExperiment)

# int_impute = log2Int
exactly_post_imp_mq <- as_tibble(exactly_post_imp_mq) %>%
  left_join(mq_with_ids) %>%
  dplyr::rename(Majority.protein.IDs=`majority protein ids`,
                Fasta.headers=`fasta headers`) %>%
  dplyr::rename(SampleName = mqExperiment)

mq_1prot <- assign_uniprot_ids_mq(exactly_post_imp_mq)
mq_1prot <- mq_1prot %>%  
  dplyr::select("ProteinId", "SampleName", "int_impute") 

compare_final <- long_me[,c("ProteinId","SampleName","IntME")] %>% 
  left_join(mq_1prot[c("ProteinId", "SampleName","int_impute")]) 

ggplot(compare_final, aes(x = IntME, y = int_impute)) + geom_point()
```


# Two runs of MassExpression

They are the same.

```{r}
prot01_1 <- readRDS("one_line_post_imp_ME_prot01_1.rds")
prot01 <- readRDS("one_line_post_imp_ME_prot01.rds")
```

# Mistery revealed

1. Using the random seed, rnorm within data.table returns the same vector of random values
2. However, is the subsetting and ordering in which those values are assigned to the matrix. Since the protein ID are different between MassExpression (Uniprot ID) and maxquant (which using id: 1,2,3,4) when selecting the subset of samples to impute, produces a different order in the selection. If we have the same exact starting data, same sample names and same protein ids, same exact starting experiment, then we will have the same result. 


```{r}
library(data.table)
f_imputePosition <- 1.8
f_imputeStDev <- 0.3
myQuantDT <- data.table(Imputed = c(0L, 1L, 1L, 0L, 0L),
                        log2Norm = c(23, 0, 0, 24, 100), 
                        SampleName = c("S1", "S1", "S2", "S2", "S3"),
                        ProteinId = c("P1","P2","P1","P2","P1"))

pid <- myQuantDT[order(ProteinId)]
sid <- myQuantDT[order(SampleName)]

pid_imp <- imputeLFQ(myQuantDT = pid, id_type = "ProteinId",int_type = "log2Norm", f_imputePosition = f_imputePosition, 
          f_imputeStDev=f_imputeStDev)

sid_imp <- imputeLFQ(myQuantDT = sid, id_type = "ProteinId",int_type = "log2Norm", f_imputePosition = f_imputePosition, 
          f_imputeStDev=f_imputeStDev)


# pid
setnames(pid, int_type, "int_impute")
pid <- pid[, colnames(pid) != int_type, with = F]
impute.StdDev <-
    f_imputeStDev * pid[Imputed == 0, sd(int_impute)]
impute.position <-
    pid[Imputed == 0, mean(int_impute)] - f_imputePosition * pid[Imputed == 0, sd(int_impute)]

set.seed(255)
pid[Imputed == 1, int_impute := rnorm(.N, (impute.position), (impute.StdDev))]
setnames(pid, "int_impute", int_type)
 
# sid
setnames(sid, int_type, "int_impute")
sid <- sid[, colnames(sid) != int_type, with = F]
impute.StdDev <-
    f_imputeStDev * sid[Imputed == 0, sd(int_impute)]
impute.position <-
    sid[Imputed == 0, mean(int_impute)] - f_imputePosition * sid[Imputed == 0, sd(int_impute)]

set.seed(255)
sid[Imputed == 1, int_impute := rnorm(.N, (impute.position), (impute.StdDev))]
setnames(sid, "int_impute", int_type)
```


## After imputation

```{r}
me <- readRDS("longIntensityDT_afterImp.rds")
me$SampleName <- gsub("LFQ.intensity.","", me$SampleName)
me$SampleName <- tolower(me$SampleName)
mq <- readRDS("merge_dt.rds") %>%
  dplyr::rename(Majority.protein.IDs=`majority protein ids`,
                Fasta.headers=`fasta headers`) %>%
  dplyr::rename(SampleName = mqExperiment)
mq_1prot <- assign_uniprot_ids_mq(mq)
compare_impute <- me[,c("ProteinId","SampleName","log2NIntNorm")] %>% 
  left_join(mq_1prot[c("ProteinId", "SampleName","log2NInt")]) 
```

```{r}
ggplot(compare_impute, aes(x = log2NIntNorm, y = log2NInt)) + geom_point()
```


- Using `log2NInt` column for imputation - only log2 of the available data - the missing data are 0  

**MQ worflow pre imputation**
- Using the `log2NInt` as int_type

**ME worflow pre imputation**
- Using the `log2NIntNorm` as int_type



# Two runs of mass expression


```{r}
colnames(expected_complete)[2:ncol(expected_complete)] <- paste0("saved_",colnames(expected_complete)[2:ncol(expected_complete)])

colnames(expected_complete_new)[2:ncol(expected_complete_new)] <- paste0("new_",colnames(expected_complete_new)[2:ncol(expected_complete_new)])

compare_me <- as_tibble(expected_complete) %>% left_join(as_tibble(expected_complete_new))
```


```{r}
ggplot(compare_me, aes(x=`saved_logFC.AZD8931_resistant_SKBR3_AZDRc.Parental_SKBR3`, 
                    y = `new_logFC.AZD8931_resistant_SKBR3_AZDRc.Parental_SKBR3`)) + 
  geom_point() +
  theme_bw() +
  geom_smooth()
```


# Enrichment

