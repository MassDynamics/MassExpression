---
title: "Test wrong inputs in app"
output: html_document
---


```{r}
library(readr)
```


# Test data in app

- Sheep data from WEHI - created by hand?

```{r}
intensities <- read_delim("../data-private/protein_intensities.tsv", delim = "\t")
design <- read_delim("../data-private/experiment_design.tsv", delim = "\t")
parameters <- read_delim("../data-private/parameters.tsv", delim = "\t", col_names = FALSE)
```

# Make wrong data

1. More names in the design than available in the intensities
2. Less than 3 replicates in one condition - done
3. Only one level in the condition
4. Wrong intensity values in one of the intensty columns

```{r two-repl-in-group}
design_2repl <- design %>% filter(Replicate_1 %in% c("P3905_01", "P3905_02", "P3905_31"))
intensities_2repl <- intensities %>% dplyr::select(ProteinId, "P3905_01", "P3905_02", "P3905_31")

write_delim(intensities_2repl, "../data-private/protein_intensities_2repl.tsv", delim = "\t")
write_delim(design_2repl, "../data-private/experiment_design_2repl.tsv", delim = "\t")
```


```{r extra-row-in-design}
design_morerepl <- cbind(design, design[3,])
design_morerepl$SampleName[nrow(design_morerepl)] <- "Extra_row"

write_delim(design_morerepl, "../data-private/more_repl_in_design/experiment_design.tsv", delim = "\t")
```

```{r one-level-in-condition}
design_morerepl <- design[1:3,]
write_delim(design_morerepl, "../data-private/one_level/experiment_design.tsv", delim = "\t")
```


```{r wrong-intensity}
intensities_wrong <- intensities 
intensities_wrong$P3905_01[1] <- ""
intensities_wrong$P3905_02[1] <- NA
intensities_wrong$P3905_03[1] <- "agh"
intensities_wrong$P3905_04[1] <- -10

dir.create("../data-private/wrong_intensity/")
write_delim(intensities_wrong, "../data-private/wrong_intensity/protein_intensities.tsv", delim = "\t")
```

- Wrong protein ID name

```{r}
intensities_wrong <- intensities
intensities_wrong <- intensities_wrong %>% dplyr::rename(ProteinIds = ProteinId)
write_delim(intensities_wrong, "../data-private/wrong-protein-id-name/protein_intensities.tsv", delim = "\t")
```


- Wrong protein entry: NA

```{r}
intensities_wrong <- intensities
intensities_wrong$ProteinId[1] <- NA
write_delim(intensities_wrong, "../data-private/wrong-protein-id-entry-NA/protein_intensities.tsv", delim = "\t")
```

- Wrong protein entry: Empty

```{r}
intensities_wrong <- intensities
intensities_wrong$ProteinId[1] <- ""
write_delim(intensities_wrong, "../data-private/wrong-protein-id-entry-empty/protein_intensities.tsv", delim = "\t")
```


- Wrong protein entry: Random string

```{r}
intensities_wrong <- intensities
intensities_wrong$ProteinId[1] <- ","
write_delim(intensities_wrong, "../data-private/wrong-protein-id-entry-random-string/protein_intensities.tsv", delim = "\t")
```

