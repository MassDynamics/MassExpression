---
title: "anna_dev"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(readxl)
```


## Parse DIA-NN data

```{r}
pg <- read_delim("../../data-s3/data-formats/diann/sheep-data-WEHI/data/Sheepplasma.pg_matrix.tsv", "\t", escape_double = FALSE, trim_ws = TRUE)
design <- read_delim("../../data-s3/data-formats/diann/sheep-data-WEHI/data/experimental design table.xlsx - Samples.csv", delim = ",")
design$Replicate <- design$IntensityColumn
```


```{r format-data}
prot <- pg %>%
  dplyr::select(contains(design$IntensityColumn))

match_colnames <- sapply( design$IntensityColumn, function(z) which(str_detect(colnames(prot), z)))
colnames(prot)[match_colnames] <- names(match_colnames)

prot[is.na(prot)] <- 0  

prot <- cbind(pg[,c("Protein.Group", "Genes", "First.Protein.Description")], prot)
prot <- prot %>% dplyr::rename(ProteinId = Protein.Group, GeneId=Genes, Description=First.Protein.Description)

# Design 

diann_sheep_data <- list(intensities = prot, design = design)
save(diann_sheep_data, file = "./../data-private/example_diann_sheep.rda")

```



